<project name="RIAC Blocks" app="Snap! 7dev, https://snap.berkeley.edu" version="2"><notes></notes><thumbnail>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAB4CAYAAAB1ovlvAAAAAXNSR0IArs4c6QAAAz1JREFUeF7t1z1KLGEQheFPccBktuB+3ICggT/gTtzObML1iInJIAZ9wewKJscDBfp0XlXw9AtNn2zbti0PgSGBEwEOyTv7KSBAIYwKCHCU33EBamBUQICj/I4LUAOjAgIc5XdcgBoYFRDgKL/jAtTAqIAAR/kdF6AGRgUEOMrvuAA1MCogwFF+xwWogVEBAY7yOy5ADYwKCHCU33EBamBUQICj/I4LUAOjAgIc5XdcgBoYFRDgKL/jAtTAqIAAR/kdF6AGRgUEOMrvuAA1MCogwFF+xwWogVEBAY7yOy5ADYwKCHCU33EBamBUQICj/I4LUAOjAgIc5XdcgBoYFRDgKL/jAtTAqIAAR/kdF6AGRgUEOMrvuAA1MCogwFF+xwWogVEBAY7yOy5ADYwKCHCU33EBamBUQICj/I4LUAOjAgIc5XdcgBoYFRBgyH84HNbr6+u6vLxcFxcX4RZjAgwbeHt7W4+Pj+vj42O9vLys6+vrdXZ2tu7u7tb5+Xm49e+NCfAH7/z5+Xk9PT2t/X7/35bj8bju7+/Xtm2fYXq+FxDgD+r4LsD39/d1e3u7Tk9P19XV1Q8u/P5RAYbv+Osn+Obm5vMT/PDwsHa7Xbj1740JMHznfkJCuC9jAuw42hIKCDCEM9YREGDH0ZZQQIAhnLGOgAA7jraEAgIM4Yx1BATYcbQlFBBgCGesIyDAjqMtoYAAQzhjHQEBdhxtCQUEGMIZ6wgIsONoSyggwBDOWEdAgB1HW0IBAYZwxjoCAuw42hIKCDCEM9YREGDH0ZZQQIAhnLGOgAA7jraEAgIM4Yx1BATYcbQlFBBgCGesIyDAjqMtoYAAQzhjHQEBdhxtCQUEGMIZ6wgIsONoSyggwBDOWEdAgB1HW0IBAYZwxjoCAuw42hIKCDCEM9YREGDH0ZZQQIAhnLGOgAA7jraEAgIM4Yx1BATYcbQlFBBgCGesIyDAjqMtoYAAQzhjHQEBdhxtCQUEGMIZ6wgIsONoSyggwBDOWEdAgB1HW0IBAYZwxjoCAuw42hIKCDCEM9YREGDH0ZZQQIAhnLGOgAA7jraEAgIM4Yx1BATYcbQlFBBgCGesIyDAjqMtocA/LZMXt9FO1h8AAAAASUVORK5CYII=</thumbnail><scenes select="1"><scene name="RIAC Blocks"><notes></notes><palette><category name="RIAC" color="216,45,45,1"/><category name="eBrain" color="0,0,0,1"/></palette><hidden></hidden><headers></headers><code></code><blocks><block-definition s="connect to IP %&apos;ip&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><block s="reportJoinWords"><list><l>if (eb == null ) {eb = new EveBrain(&apos;ws://</l><block var="ip"/><l>:8899/websocket&apos;);&#xD;console.log(eb.connected);&#xD;} else {&#xD;if (eb.connected == false) {&#xD;eb.url= "ws://</l><block var="ip"/><l>:8899/websocket";  eb.connect();}}</l></list></block></block><list></list></block></script></block-definition><block-definition s="connect USB" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>USBconnect();</l></block><list></list></block></script></block-definition><block-definition s="connected" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>&#xD;try {&#xD;  if ((eb != undefined ? eb.connected : false) || (world.USB != &apos;&apos; &amp;&amp; world.USB != undefined)){&#xD;    return true; &#xD;  } else {&#xD;    return false;&#xD;  }&#xD;} catch(e) {&#xD;  return false;&#xD;}</l></block><list></list></block></block></script></block-definition><block-definition s="test connection" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>try {&#xD;&#xD;  if ((eb != undefined ? eb.connected : false) || (world.USB != &apos;&apos; &amp;&amp; world.USB != undefined)){&#xD;    //it thinks its connected over websock, let&apos;s test the connection&#xD;   if (eb != undefined ? eb.connected : false) {&#xD;     eb.connected = false;&#xD;     eb.version(function(status,msg){eb.connected = true;});&#xD;   } else {&#xD;     //it thinks we are connected over USB&#xD;     world.USB = &apos;&apos;;&#xD;     writeToStream(&apos; {cmd: "version", id: "k1q6if75si"} &apos;);&#xD;   } &#xD;  }&#xD;} catch(e) {&#xD;  console.log(e);&#xD;}</l></block><list></list></block></script></block-definition><block-definition s="Connect to eBrain %&apos;ip&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doIf"><block s="reportNot"><custom-block s="world modified"></custom-block></block><script><custom-block s="addJS %s"><custom-block s="eBrainJS"></custom-block></custom-block><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.modified = 1;</l></block><list></list></block></script></block><custom-block s="test connection"></custom-block><block s="doWait"><l>0.1</l></block><block s="doIf"><block s="reportNot"><custom-block s="connected"></custom-block></block><script><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;http:&apos;</l></block><list></list></block><script><block s="doIfElse"><block var="ip"/><script><custom-block s="connect to IP %s"><block var="ip"/></custom-block></script><script><custom-block s="connect"></custom-block></script></block></script></block><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;https:&apos;</l></block><list></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.port = &apos;&apos;;</l></block><list></list></block><custom-block s="connect USB"></custom-block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>eb == undefined;&#xD;return world.port;</l></block><list></list></block></block></script></block><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;file:&apos;</l></block><list></list></block><script><block s="doIfElse"><block s="reportEquals"><block var="ip"/><l>USB</l></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>world.port = &apos;&apos;;</l></block><list></list></block><custom-block s="connect USB"></custom-block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.port</l></block><list></list></block></block></script><script><block s="doIfElse"><block var="ip"/><script><custom-block s="connect to IP %s"><block var="ip"/></custom-block></script><script><custom-block s="connect"></custom-block></script></block></script></block></script></block><block s="doWait"><l>0.1</l></block><block s="doIf"><block s="reportNot"><custom-block s="connected"></custom-block></block><script><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;http:&apos;</l></block><list></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>alert("Websocket Connection Failure! \n\nEnsure you are connected to the eBrain over the network, this version of Snap (http) cannot use the USB port.\n\n See Help for more details");</l></block><list></list></block></script></block><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;https:&apos;</l></block><list></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>alert("USB Connection Failure!\n\nThis version of Snap (https) is secure and can only connect over USB, if you wish to connect using WebSockets please navigate to http.\n\nPlease connect your eBrain using a USB cable and make sure you have selected the correct port to commnicate with the eBrain");</l></block><list></list></block></script></block><block s="doIf"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return location.protocol == &apos;file:&apos;</l></block><list></list></block><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>alert("Connection Failure!\n\nIn this mode you may connect via USB or over WebSocket\n\nPlease type the IP address to use WebSockets or type USB to use the USB port")</l></block><list></list></block></script></block></script></block></script></block></script></block-definition><block-definition s="eBrainJS" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><l>var eb,escapable=/[\x00-\x1f\ud800-\udfff\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufff0-\uffff]/g,attempts=0;function filterUnicode(t){return escapable.lastIndex=0,escapable.test(t)?t.replace(escapable,function(t){return""}):t}var EveBrain=function(t){this.url=t,this.connect(),this.cbs={},this.listeners=[],this.sensorState={follow:null,collide:null},this.analogSensor={level:null},this.digitalSensor={level:null},this.wifiNetworks={},this.ipAddress={},this.distanceSensor={level:null},this.tempSensor={level:null},this.humidSensor={level:null}};let inputDone,outputDone;async function USBconnect(){world.port=await navigator.serial.requestPort(),await world.port.open({baudRate:230400});const t=new TextEncoderStream;outputDone=t.readable.pipeTo(world.port.writable),world.outputStream=t.writable,writeToStream(&apos; {cmd: "version", id: "k1q6if75si"} &apos;);let e=new TextDecoderStream;inputDone=world.port.readable.pipeTo(e.writable),inputStream=e.readable,world.reader=inputStream.getReader(),readLoop()}async function readLoop(){for(world.USB="",console.log("USB Reader Listening...");;){const{value:t,done:e}=await world.reader.read();if(t&amp;&amp;(t.includes("{")&amp;&amp;(world.USB=""),world.USB+=t,console.log(t+"\n")),e){console.log("[readLoop] DONE",e),world.reader.releaseLock();break}}}function writeToStream(...t){const e=world.outputStream.getWriter();t.forEach(t=&gt;{console.log("[SEND]",t),e.write(t+"\n")}),e.releaseLock()}EveBrain.prototype={connected:!1,error:!1,timeoutTimer:void 0,connect:function(){if(!this.connected&amp;&amp;!this.error){var t=this;try{clearTimeout(t.timeoutTimer),clearTimeout(t.connTimeout),clearTimeout(t.reconnectTimer),t.ws.close(),t.robot_state="idle",t.msg_stack=[],t.cbs={}}catch(t){console.log(t)}this.has_connected=!1,this.ws=filterUnicode(new WebSocket(this.url)),this.ws.onmessage=function(e){t.handle_ws(e)},this.ws.onopen=function(){t.version(function(){t.setConnectedState(!0),attempts=0})},this.ws.onerror=function(e){t.handleError(e),attempts+=1},this.ws.onclose=function(e){t.handleError(e),attempts+=1},attempts&lt;10&amp;&amp;(this.connTimeout=window.setTimeout(function(){if(!t.connected)try{t.ws.close()}catch(t){console.log(t)}},1e3))}},refresh:function(){var t=this;t.ws.close(),clearTimeout(t.connTimeout),t.robot_state="idle",t.msg_stack=[],t.cbs={},this.has_connected=!1,this.ws=filterUnicode(new WebSocket(this.url)),this.ws.onmessage=function(e){t.handle_ws(e)},this.ws.onopen=function(){t.version(function(){t.setConnectedState(!0)})},this.ws.onerror=function(e){t.handleError(e)},this.ws.onclose=function(e){t.handleError(e)}},setConnectedState:function(t){var e=this;clearTimeout(e.connTimeout),e.connected=t,t&amp;&amp;(e.has_connected=!0),e.has_connected&amp;&amp;setTimeout(function(){e.broadcast(e.connected?"connected":"disconnected")},100),t?e.reconnectTimer&amp;&amp;(clearTimeout(e.reconnectTimer),e.reconnectTimer=void 0):!e.reconnectTimer&amp;&amp;attempts&lt;10&amp;&amp;(e.reconnectTimer=setTimeout(function(){e.reconnectTimer=void 0,e.connect()},1e3))},broadcast:function(t){for(i in this.listeners)this.listeners.hasOwnProperty(i)&amp;&amp;this.listeners[i](t)},addListener:function(t){this.listeners.push(t)},handleError:function(t){t instanceof CloseEvent||"Timeout"===t?(this.ws.readyState===WebSocket.OPEN&amp;&amp;this.ws.close(),this.setConnectedState(!1),clearTimeout(self.reconnectTimer),self.reconnectTimer=void 0,this.msg_stack=[]):console.log(t)},move:function(t,e,s){this.send({cmd:t,arg:e},s)},turn:function(t,e,s){this.send({cmd:t,arg:e},s)},forward:function(t,e){this.move("forward",t,e)},back:function(t,e){this.move("back",t,e)},left:function(t,e){this.move("right",t,e)},right:function(t,e){this.move("left",t,e)},leftMotorForward:function(t,e){this.move("leftMotorF",t,e)},rightMotorForward:function(t,e){this.move("rightMotorF",t,e)},leftMotorBackward:function(t,e){this.move("leftMotorB",t,e)},rightMotorBackward:function(t,e){this.move("rightMotorB",t,e)},arc:function(t,e,s,n){this.send({cmd:"arc",arg:[t,e,s]},n)},gpio:function(t,e,s){this.send({cmd:e[0],arg:t},s)},analogInput:function(t,e){var s=this;this.send({cmd:"analogInput",arg:t},function(t,n){"complete"===t&amp;&amp;null!=n&amp;&amp;(s.analogSensor.level=n.msg,e(s.analogSensor.level))})},analogInputPCF:function(t,e){var s=this;this.send({cmd:"readSensors",arg:t},function(t,n){"complete"===t&amp;&amp;null!=n&amp;&amp;(s.analogSensor.level=n.msg,e(s.analogSensor.level))})},temperature:function(t){var e=this;this.send({cmd:"temperature"},function(s,n){"complete"===s&amp;&amp;null!=n&amp;&amp;(e.tempSensor.level=n.msg,t(e.tempSensor.level))})},humidity:function(t){var e=this;this.send({cmd:"humidity"},function(s,n){"complete"===s&amp;&amp;null!=n&amp;&amp;(e.humidSensor.level=n.msg,t(e.humidSensor.level))})},digitalInput:function(t,e){var s=this;this.send({cmd:"digitalInput",arg:t},function(t,n){"complete"===t&amp;&amp;null!=n&amp;&amp;(s.digitalSensor.level=n.msg,e(s.digitalSensor.level))})},distanceInput:function(t){var e=this;this.send({cmd:"distanceSensor"},function(s,n){"complete"===s&amp;&amp;null!=n&amp;&amp;(e.distanceSensor.level=n.msg,t(e.distanceSensor.level))})},gpio_pwm:function(t,e,s){this.send({cmd:t,arg:e},s)},servo:function(t,e){this.send({cmd:"servo",arg:t},e)},beep:function(t,e,s){this.send({cmd:"beep",arg:[t,1e3*e]},s)},stop:function(t){var e=this;this.send({cmd:"stop"},function(s,n,o){if("complete"===s&amp;&amp;!o){for(var i in e.cbs)e.cbs[i]("complete",void 0,!0);e.robot_state="idle",e.msg_stack=[],e.cbs={},t&amp;&amp;t(s)}})},pause:function(t){this.send({cmd:"pause"},t)},resume:function(t){this.send({cmd:"resume"},t)},ping:function(t){this.send({cmd:"ping"},t)},version:function(t){this.send({cmd:"version"},t)},getNetworks:function(t){this.send({cmd:"startWifiScan"},function(e,s){"notify"===e&amp;&amp;null!=s&amp;&amp;t(s.msg)})},getIp:function(t){this.send({cmd:"getConfig"},function(e,s){"complete"===e&amp;&amp;null!=s&amp;&amp;t(s.msg)})},send:function(t,e){(t=filterUnicode(t)).id=Math.random().toString(36).substr(2,10),e&amp;&amp;(this.cbs[t.id]=e),t.arg&amp;&amp;(t.arg=t.arg.toString()),["stop","pause","resume","ping","version"].indexOf(t.cmd)&gt;=0?this.send_msg(t):(this.msg_stack.push(t),this.process_msg_queue())},send_msg:function(t){var e=this;t=filterUnicode(t),console.log(t),this.ws.readyState===WebSocket.OPEN&amp;&amp;this.ws.send(JSON.stringify(t)),this.timeoutTimer=window.setTimeout(function(){e.handleError("Timeout")},3e3)},process_msg_queue:function(){"idle"===this.robot_state&amp;&amp;this.msg_stack.length&gt;0&amp;&amp;(this.robot_state="receiving",this.send_msg(this.msg_stack[0]))},handle_ws:function(t){if(void 0!==t){if(msg=JSON.parse(t.data),msg.msg=filterUnicode(msg.msg),msg.id=filterUnicode(msg.id),msg.status=filterUnicode(msg.status),console.log(msg),clearTimeout(this.timeoutTimer),"notify"===msg.status)return this.broadcast(msg.id),void(this.sensorState[msg.id]=msg.msg);this.msg_stack.length&gt;0&amp;&amp;this.msg_stack[0].id==msg.id?"accepted"===msg.status?(this.cbs[msg.id]&amp;&amp;this.cbs[msg.id]("started",msg),this.robot_state="running"):"complete"===msg.status&amp;&amp;(this.cbs[msg.id]&amp;&amp;(this.cbs[msg.id]("complete",msg),delete this.cbs[msg.id]),this.msg_stack.shift(),0===this.msg_stack.length&amp;&amp;this.broadcast("program_complete"),this.robot_state="idle",this.process_msg_queue()):this.cbs[msg.id]&amp;&amp;(this.cbs[msg.id]("complete",msg),delete this.cbs[msg.id]),msg.status&amp;&amp;"error"===msg.status&amp;&amp;"Too many connections"===msg.msg&amp;&amp;(this.error=!0,this.broadcast("error"))}else t.data=0,t.status=0,t.id=0},robot_state:"idle",msg_stack:[]};</l></block></script></block-definition><block-definition s="addJS %&apos;JS_FILE&apos;" type="command" category="other"><header></header><code></code><translations></translations><inputs><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>JS_FILE</l></list><l>var po = document.createElement(&apos;script&apos;);&#xD;  po.type = &apos;text/javascript&apos;;&#xD;  po.async = true;&#xD;  po.innerHTML = JS_FILE;&#xD;  var s = document.getElementsByTagName(&apos;script&apos;)[0];&#xD;  s.parentNode.insertBefore(po, s)</l></block><list><block var="JS_FILE"/></list></block></script></block-definition><block-definition s="world modified" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return world.modified == 1 || world.modified != undefined;</l></block><list></list></block></block></script></block-definition><block-definition s="USB" type="reporter" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><l>USB</l></block></script></block-definition><block-definition s="WiFi" type="reporter" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><l>192.168.4.1</l></block></script></block-definition><block-definition s="WiFi IP: %&apos;ip&apos;" type="reporter" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s">192.168.4.1</input></inputs><script><block s="doReport"><block var="ip"/></block></script></block-definition><block-definition s="Forward %&apos;mm&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s">100</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l></list><l>world.USB = &apos;0&apos;;&#xD;world.moveon = 0;&#xD;if (eb != undefined ? eb.connected : false) {&#xD;//connected over websocket&#xD;  eb.forward(mm,function(state,msg){&#xD;        if(state == &apos;complete&apos;){&#xD;          world.moveon = 1;&#xD;        }&#xD;  });&#xD;} else {&#xD;//connected over USB&#xD;  writeToStream(&apos; {arg: &apos;+ mm +&apos;, cmd: "forward", id: "k1q6if75si"} &apos;);&#xD;}</l></block><list><block var="mm"/></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>var msg = JSON.parse(world.USB);&#xD;return (world.moveon || msg.status == &apos;complete&apos;);</l></block><list></list></block></block></script></block-definition><block-definition s="Back %&apos;mm&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s">100</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l></list><l>world.USB = &apos;0&apos;;&#xD;world.moveon = 0;&#xD;if (eb != undefined ? eb.connected : false) {&#xD;//connected over websocket&#xD;  eb.back(mm,function(state,msg){&#xD;        if(state == &apos;complete&apos;){&#xD;          world.moveon = 1;&#xD;        }&#xD;  });&#xD;} else {&#xD;//connected over USB&#xD;  writeToStream(&apos; {arg: &apos;+ mm +&apos;, cmd: "back", id: "k1q6if75si"} &apos;);&#xD;}</l></block><list><block var="mm"/></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>var msg = JSON.parse(world.USB);&#xD;return (world.moveon || msg.status == &apos;complete&apos;);</l></block><list></list></block></block></script></block-definition><block-definition s="Left %&apos;mm&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s">90</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l></list><l>world.USB = &apos;0&apos;;&#xD;world.moveon = 0;&#xD;if (eb != undefined ? eb.connected : false) {&#xD;//connected over websocket&#xD;  eb.left(mm,function(state,msg){&#xD;        if(state == &apos;complete&apos;){&#xD;          world.moveon = 1;&#xD;        }&#xD;  });&#xD;} else {&#xD;//connected over USB&#xD;  writeToStream(&apos; {arg: &apos;+ mm +&apos;, cmd: "left", id: "k1q6if75si"} &apos;);&#xD;}</l></block><list><block var="mm"/></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>var msg = JSON.parse(world.USB);&#xD;return (world.moveon || msg.status == &apos;complete&apos;);</l></block><list></list></block></block></script></block-definition><block-definition s="Right %&apos;mm&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s">90</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>mm</l></list><l>world.USB = &apos;0&apos;;&#xD;world.moveon = 0;&#xD;if (eb != undefined ? eb.connected : false) {&#xD;//connected over websocket&#xD;  eb.right(mm,function(state,msg){&#xD;        if(state == &apos;complete&apos;){&#xD;          world.moveon = 1;&#xD;        }&#xD;  });&#xD;} else {&#xD;//connected over USB&#xD;  writeToStream(&apos; {arg: &apos;+ mm +&apos;, cmd: "right", id: "k1q6if75si"} &apos;);&#xD;}</l></block><list><block var="mm"/></list></block><block s="doWaitUntil"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>var msg = JSON.parse(world.USB);&#xD;return (world.moveon || msg.status == &apos;complete&apos;);</l></block><list></list></block></block></script></block-definition><block-definition s="connect" type="command" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l></l></list><l>if (eb == null) {&#xD;eb = new EveBrain(&apos;ws://192.168.4.1:8899/websocket&apos;);&#xD;&#xD;console.log(eb.connected);&#xD;} else {&#xD;if (eb.connected == false) {&#xD;eb.url = "ws://192.168.4.1:8899/websocket";&#xD;eb.connect();&#xD;}&#xD;}</l></block><list></list></block></script></block-definition><block-definition s="connection type" type="reporter" category="other"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>try {&#xD;  if(eb != undefined ? eb.connected : false){&#xD;    return &apos;WEB&apos;; &#xD;  }  &#xD; else if(world.USB != &apos;&apos; &amp;&amp; world.USB != undefined){&#xD;    return &apos;USB&apos;; &#xD;  }&#xD; else {&#xD;   return &apos;NONE&apos;; &#xD;  }&#xD;} catch(e) {&#xD;  return "NONE";&#xD;}</l></block><list></list></block></block></script></block-definition><block-definition s="GPIO Write Pin: %&apos;Pin&apos; %&apos;ON/OFF&apos;" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">4<options>4&#xD;5&#xD;10&#xD;16&#xD;14&#xD;12&#xD;13&#xD;0&#xD;2</options></input><input type="%s" readonly="true">ON<options>ON=gpio_on&#xD;OFF=gpio_off</options></input></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doRun"><block s="reportJSFunction"><list><l>Pin</l><l>State</l></list><l>try{&#xD;eb.gpio(Pin,[State],function(){});&#xD;}&#xD;catch(e){&#xD;}</l></block><list><block var="Pin"/><block var="ON/OFF"/></list></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doRun"><block s="reportJSFunction"><list><l>Pin</l><l>State</l></list><l>try{&#xD;writeToStream(&apos; {arg: &apos;+Pin+&apos;, cmd: "&apos;+State+&apos;", id: "k1q6if75si"} &apos;);&#xD;}&#xD;catch(e){&#xD;}</l></block><list><block var="Pin"/><block var="ON/OFF"/></list></block></script></block></script></block-definition><block-definition s="GPIO Read Pin: %&apos;Pin&apos;" type="reporter" category="RIAC"><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true">4<options>4&#xD;5&#xD;10&#xD;16&#xD;14&#xD;12&#xD;13&#xD;0&#xD;2</options></input></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>Pin</l></list><l>try{&#xD;eb.digitalInput(Pin,function(){});&#xD;return eb.digitalSensor.level;&#xD;}&#xD;catch(e){&#xD;return 0;&#xD;}</l></block><list><block var="Pin"/></list></block></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>Pin</l></list><l>try { &#xD;writeToStream(&apos;{cmd: "digitalInput", arg: &apos;+Pin+&apos;, id: "k1q6if75si"}&apos;);&#xD;var J = JSON.parse(world.USB);&#xD;return J.msg;&#xD;}&#xD;catch(e) {&#xD;return 0;&#xD;}</l></block><list><block var="Pin"/></list></block></block></script></block></script></block-definition><block-definition s="Analog Read" type="reporter" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list></list><l>function next(e) {;&#xD;return eb.analogSensor;&#xD;}&#xD;eb.analogInput(0,next);&#xD;return eb.analogSensor.level;</l></block><list></list></block></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list></list><l>try{&#xD;writeToStream(&apos;{cmd: "analogInput", arg: "A0", id: "k1q6if75si"}&apos;);&#xD;var J = JSON.parse(world.USB);&#xD;return J.msg;&#xD;}&#xD;catch(e){&#xD;return 0; &#xD;}</l></block><list></list></block></block></script></block></script></block-definition><block-definition s="Stop" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>//eb.gpio(Pin,[State],function(){});&#xD;eb.stop();</l></block><list></list></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>try{&#xD;writeToStream(&apos; {cmd: "stop", id: "k1q6if75si"} &apos;);&#xD;}&#xD;catch(e) {&#xD;} </l></block><list></list></block></script></block></script></block-definition><block-definition s="Pause" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>eb.pause();</l></block><list></list></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>try{&#xD;writeToStream(&apos; {cmd: "pause", id: "k1q6if75si"} &apos;);&#xD;}&#xD;catch(e){&#xD;}&#xD;</l></block><list></list></block></script></block></script></block-definition><block-definition s="Resume" type="command" category="RIAC"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>WEB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>//eb.gpio(Pin,[State],function(){});&#xD;eb.resume();</l></block><list></list></block></script></block><block s="doIf"><block s="reportEquals"><custom-block s="connection type"></custom-block><l>USB</l></block><script><block s="doRun"><block s="reportJSFunction"><list></list><l>try{&#xD;writeToStream(&apos; {cmd: "resume", id: "k1q6if75si"} &apos;);&#xD;}&#xD;catch(e){&#xD;}</l></block><list></list></block></script></block></script></block-definition><block-definition s="Connect to Wifi over USB %&apos;SSID&apos; %&apos;PASS&apos;" type="command" category="eBrain"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>SSID</l><l>PASS</l></list><l>try{&#xD;writeToStream(&apos;{cmd: "setConfig", arg:{\&apos;sta_ssid\&apos;:\&apos;&apos;+SSID+&apos;\&apos;,\&apos;sta_pass\&apos;:\&apos;&apos;+PASS+&apos;\&apos;}, id: "3d8d9d4f6k"}&apos;);&#xD;}&#xD;catch(e){&#xD;console.log(0)&#xD;}</l></block><list><block var="SSID"/><block var="PASS"/></list></block></script></block-definition></blocks><variables></variables><stage width="480" height="360" costume="0" color="255,255,255,1" tempo="60" threadsafe="false" penlog="false" volume="100" pan="0" lines="round" ternary="false" hyperops="true" codify="false" inheritance="true" sublistIDs="false" scheduled="false" id="669"><pentrails>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAFoCAYAAACPNyggAAAAAXNSR0IArs4c6QAADoVJREFUeF7t1cEJAAAIxDDdf2m3sJ+4wEEQuuMIECBAgACBd4F9XzRIgAABAgQIjAB7AgIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECAiwHyBAgAABAoGAAAfoJgkQIECAgAD7AQIECBAgEAgIcIBukgABAgQICLAfIECAAAECgYAAB+gmCRAgQICAAPsBAgQIECAQCAhwgG6SAAECBAgIsB8gQIAAAQKBgAAH6CYJECBAgIAA+wECBAgQIBAICHCAbpIAAQIECByxcQFpoRMBzwAAAABJRU5ErkJggg==</pentrails><costumes><list struct="atomic" id="670"></list></costumes><sounds><list struct="atomic" id="671"></list></sounds><variables></variables><blocks></blocks><scripts></scripts><sprites select="1"><sprite name="Sprite" idx="1" x="24" y="0" heading="90" scale="1" volume="100" pan="0" rotation="1" draggable="true" costume="0" color="80,80,80,1" pen="tip" id="676"><costumes><list struct="atomic" id="677"></list></costumes><sounds><list struct="atomic" id="678"></list></sounds><blocks></blocks><variables></variables><scripts><script x="105.49999999999983" y="5.000000000000007"><block s="receiveGo"></block><custom-block s="Connect to eBrain %s"><custom-block s="WiFi IP: %s"><l>10.0.1.78</l></custom-block></custom-block></script></scripts></sprite></sprites></stage></scene></scenes></project>